{% extends "admin/base.html" %}

{% block content %}
<style>
    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background-color: #f4f6f9;
        color: #333;
        line-height: 1.6;
    }

    .wrapper {
        max-width: 1000px;
        margin: 40px auto;
        padding: 20px;
    }

    .card {
        background: #fff;
        border-radius: 10px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        overflow: hidden;
    }

    .card-header {
        background: linear-gradient(to right, #17a2b8, #138496);
        color: white;
        padding: 20px;
        border-bottom: 1px solid #ddd;
    }

    .card-header h3 {
        font-size: 24px;
    }

    .card-body {
        padding: 25px;
    }

    .row {
        display: flex;
        flex-wrap: wrap;
        gap: 20px;
        margin-bottom: 30px;
    }

    .col {
        flex: 1;
        min-width: 300px;
    }

    .info-box {
        background-color: #f8f9fa;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
    }

    .info-box h5 {
        color: #6c757d;
        margin-bottom: 15px;
        font-weight: 600;
    }

    .badge {
        display: inline-block;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.9rem;
        font-weight: 600;
        text-transform: capitalize;
    }

    .bg-success {
        background-color: #28a745;
        color: #fff;
    }

    .bg-danger {
        background-color: #dc3545;
        color: #fff;
    }

    .bg-warning {
        background-color: #ffc107;
        color: #212529;
    }

    .bg-info {
        background-color: #17a2b8;
        color: #fff;
    }

    .complaint-content {
        background: #f8f9fa;
        border: 1px solid #ddd;
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 25px;
    }

    textarea {
        width: 100%;
        border: 1px solid #ccc;
        border-radius: 8px;
        padding: 15px;
        font-size: 16px;
        resize: vertical;
        transition: border 0.3s ease;
        min-height: 120px;
    }

    textarea:focus {
        border-color: #17a2b8;
        outline: none;
    }

    .btn-group {
        display: flex;
        gap: 10px;
        flex-wrap: wrap;
        margin-top: 10px;
    }

    .btn {
        padding: 10px 20px;
        border-radius: 50px;
        border: none;
        font-size: 16px;
        cursor: pointer;
        font-weight: 500;
        transition: background 0.3s ease;
    }

    .btn-success {
        background-color: #28a745;
        color: white;
    }

    .btn-danger {
        background-color: #dc3545;
        color: white;
    }

    .btn-outline {
        background-color: transparent;
        color: #666;
        border: 1px solid #ccc;
    }

    .btn-outline:hover {
        background-color: #eee;
    }
</style>

<div class="wrapper">
    <div class="card">
        <div class="card-header">
            <h3>üìù Review Complaint #{{ complaint._id }}</h3>
        </div>
        <div class="card-body">
            <div class="row">
                <div class="col">
                    <div class="info-box">
                        <h5>Student Information</h5>
                        <p><strong>Name:</strong> {{ student.name }}</p>
                        <p><strong>University ID:</strong> {{ student.university_id }}</p>
                        <p><strong>Email:</strong> {{ student.email }}</p>
                    </div>
                </div>

                <div class="col">
                    <div class="info-box">
                        <h5>Complaint Details</h5>
                        <p><strong>Subject:</strong> {{ subject.name }}</p>
                        <p><strong>Submitted:</strong> {{ complaint.date.strftime('%Y-%m-%d at %H:%M') }}</p>
                        <p><strong>Status:</strong>
                            <span class="badge 
                                {% if complaint.status == 'approved' %}bg-success
                                {% elif complaint.status == 'rejected' %}bg-danger
                                {% elif complaint.status == 'pending_payment' %}bg-warning
                                {% else %}bg-info{% endif %}">
                                {{ complaint.status.replace('_', ' ').title() }}
                            </span>
                        </p>
                    </div>
                </div>
            </div>

            <div class="complaint-content">
                <h5 style="color: #6c757d; margin-bottom: 10px;">Complaint Content</h5>
                <p>{{ complaint.complaint }}</p>
            </div>

            <form method="POST">
                <div class="form-group">
                    <h5 style="color: #6c757d; margin-bottom: 10px;">Your Response</h5>
                    <textarea name="response"
                        placeholder="Enter your response to the student...">{{ complaint.admin_response or '' }}</textarea>
                </div>

                <div class="btn-group">
                    <button type="submit" name="decision" value="approve" class="btn btn-success">‚úÖ Approve</button>
                    <button type="submit" name="decision" value="reject" class="btn btn-danger">‚ùå Reject</button>
                    <a href="{{ url_for('admin.manage_complaints') }}" class="btn btn-outline">‚Üê Back to List</a>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}